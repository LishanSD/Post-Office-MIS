generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  POSTMASTER
  SUPERVISOR
  RECEPTIONIST
  DISPATCHER
  POSTMAN
}

model Employee { 
  employeeID   String  @id 
  password     String?
  postalCode String  
  postOffice  PostOffice @relation(fields: [postalCode], references: [postalCode])
  employeeName String
  email         String @unique
  telephone    String 
  role         Role
  leave       Leave[]
  area        Area[]
}

enum PostOfficeCategory {
  HEAD_OFFICE
  SUB_OFFICE
}

model PostOffice {
  postalCode        String                @id
  postOfficeCategory PostOfficeCategory
  postOfficeName    String
  headOfficeID       String?
  address          Address[]
  mail	  	         Mail[]
  employee          Employee[]
  bundle            Bundle[]
  area        Area[]
}

model Address {
  addressID     Int      @id @default(autoincrement())
  postalCode    String
  postOffice  PostOffice @relation(fields: [postalCode], references: [postalCode])
  addressNo    String
  streetName    String?
  Locality      String?
  latitude      Float?
  longitude     Float?
  customer Customer[]
}

model MailCategory {
  mailCategoryID  String  @id
  categoryName  String
  PricePer1kg   Decimal?    @db.Decimal(10, 2)
  mail    Mail[]
}

model Customer {
  customerID   Int  @id  @default(autoincrement())
  postalCode    String
  customerName String   
  telephone    String?
  addressID    Int
  address      Address @relation(fields: [addressID], references: [addressID])
  mail         Mail[]
  transaction  Transaction[]
}

model Mail {
  barcodeID         Int         @id @default(autoincrement())
  recepientID       Int
  bundleID          Int
  bundle            Bundle     @relation(fields: [bundleID], references: [bundleID])
  recepient         Customer   @relation(fields: [recepientID], references: [customerID])
  postalCode        String
  postOffice        PostOffice @relation(fields: [postalCode], references: [postalCode])
  mailstatus        MailStatus
  transactionID     Int
  transaction       Transaction @relation(fields: [transactionID], references: [transactionID])
  mailCategory      MailCategory  @relation(fields: [mailCategoryID], references: [mailCategoryID])
  mailCategoryID    String
  weight            Decimal?    @db.Decimal(10, 2)
}

model Bundle {
  bundleID              Int          @id @default(autoincrement())
  destPostalCode        String
  destPostOffice        PostOffice @relation(fields: [destPostalCode], references: [postalCode])
  barcodeID              Int          
  mail                  Mail[]
}

enum MailStatus {
  IN_TRANSIT
  DELIVERED
  RETURNED
}

model Transaction {
  transactionID Int      @id @default(autoincrement())
  date          DateTime
  amount        Float
  customerID    Int
  customer      Customer @relation(fields: [customerID], references: [customerID])
  mail          Mail[]
}

model Leave{
  employeeID String   @id
  leaveType LeaveType
  startDate DateTime
  endDate DateTime
  employee Employee @relation(fields: [employeeID], references: [employeeID])
  description String
  status String
  RequestStatus RequestStatus @default(PENDING)

}

enum LeaveType{
  HALF_DAY
  FULL_DAY
}

enum RequestStatus{
  PENDING
  APPROVED
  REJECTED
}

model Area{
  areaID Int @id
  areaName String     @db.VarChar(100)
  postalCode String
  postOffice PostOffice   @relation(fields: [postalCode], references: [postalCode])
  postman Employee  @relation(fields: [employeeID], references: [employeeID])
  employeeID String
}