generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  POSTMASTER
  SUPERVISOR
  RECEPTIONIST
  DISPATCHER
  POSTMAN
}

model Employee { 
  employeeID   String  @id 
  password     String?
  postalCode String  
  postOffice  PostOffice @relation(fields: [postalCode], references: [postalCode])
  employeeName String
  email         String @unique
  telephone    String 
  role         Role
  leave       Leave[]
  area        Area[]
}

enum PostOfficeCategory {
  HEAD_OFFICE
  SUB_OFFICE
}

model PostOffice {
  postalCode        String                @id
  postOfficeCategory PostOfficeCategory
  postOfficeName    String
  headOfficeID      String?
  address           Address[]
  mail              Mail[]
  employee          Employee[]
  bundle            Bundle[]
  area              Area[]
}

model Address {
  addressID     Int      @id @default(autoincrement())
  postalCode    String
  postOffice  PostOffice @relation(fields: [postalCode], references: [postalCode])
  addressNo    String
  streetName    String?
  Locality      String?
  latitude      Float?
  longitude     Float?
  areaID        Int?
  area          Area? @relation(fields: [areaID], references: [areaID])
  transaction   Transaction[]
  mail          Mail[]
}

model MailCategory {
  mailCategoryName  String    @id
  PricePer1kg   Decimal?    @db.Decimal(10, 2)
  mail    Mail[]
}



model Mail {
  recepientName      String  
  recepientAddressID         Int
  mailID         Int         @id @default(autoincrement())
  recepientTelephone  String
  address           Address @relation(fields: [recepientAddressID], references: [addressID])
  bundleID          Int       
  bundle            Bundle     @relation(fields: [bundleID], references: [bundleID])
  mailstatus        MailStatus  @default(IN_TRANSIT)
  transactionID     Int
  transaction       Transaction @relation(fields: [transactionID], references: [transactionID])
  mailCategory      MailCategory  @relation(fields: [mailCategoryName], references: [mailCategoryName])
  mailCategoryName    String
  weight            Decimal?    @db.Decimal(10, 2)
  price             Decimal?       @db.Decimal(10,2)
  postalCode        String
  postOffice        PostOffice @relation(fields: [postalCode], references: [postalCode])
}

model Bundle {
  bundleID              Int          @id @default(autoincrement())
  destPostalCode        String
  destPostOffice        PostOffice @relation(fields: [destPostalCode], references: [postalCode])
  barcodeID              Int?          
  mail                  Mail[]
}

enum MailStatus {
  IN_TRANSIT
  DELIVERED
  RETURNED
}

model Transaction {
  customerTelephone    String?
  customerAddressID    Int
  address      Address @relation(fields: [customerAddressID], references: [addressID])
  customerName String
  transactionID Int      @id @default(autoincrement())
  date          DateTime
  amount        Decimal?       @db.Decimal(10,2)
  mail          Mail[]
}

model Leave{
  employeeID String   @id
  leaveType LeaveType
  startDate DateTime
  endDate DateTime
  employee Employee @relation(fields: [employeeID], references: [employeeID])
  description String
  status String
  RequestStatus RequestStatus @default(PENDING)

}

enum LeaveType{
  HALF_DAY
  FULL_DAY
}

enum RequestStatus{
  PENDING
  APPROVED
  REJECTED
}

model Area{
  areaID Int @id
  areaName String     @db.VarChar(100)
  postalCode String
  postOffice PostOffice   @relation(fields: [postalCode], references: [postalCode])
  postman Employee  @relation(fields: [employeeID], references: [employeeID])
  employeeID String
  addresses   Address[]
}